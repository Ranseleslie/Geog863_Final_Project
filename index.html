require([
  "esri/Map",
  "esri/views/MapView",
  "esri/layers/GeoJSONLayer",
  "esri/widgets/LayerList",
  "esri/widgets/Expand"
], function(Map, MapView, GeoJSONLayer, LayerList, Expand) {

  // Create the map
  const map = new Map({
    basemap: "streets-navigation-vector" // Esri basemap
  });

  // Create the view, centered on Charlotte, NC
  const view = new MapView({
    container: "viewDiv",
    map: map,
    center: [-80.8431, 35.2271], // Coordinates for Charlotte, NC
    zoom: 12
  });

  // Parks Layer
  const parksLayer = new GeoJSONLayer({
    url: "https://raw.githubusercontent.com/Ranseleslie/Geog863_Final_Project/main/Parks.geojson",
    title: "Parks",
    renderer: {
      type: "simple",
      symbol: {
        type: "simple-marker",
        color: "green",
        size: 10
      }
    },
    popupTemplate: {
      title: "{PRKNAME}", // Display the park name as the title
      content: "<b>Address:</b> {PRKADDR}" // Display park address in the content
    }
  });
  map.add(parksLayer);

  // Schools Layer
  const schoolsLayer = new GeoJSONLayer({
    url: "https://raw.githubusercontent.com/Ranseleslie/Geog863_Final_Project/main/Schools_(view_of_points).geojson",
    title: "Schools",
    renderer: {
      type: "simple",
      symbol: {
        type: "simple-marker",
        color: "blue",
        size: 10
      }
    },
    popupTemplate: {
      title: "{SchoolName}", // School name as the title
      content: "<b>Address:</b> {Address}" // School address in the content
    }
  });
  map.add(schoolsLayer);

  // Grocery Stores Layer
  const groceryStoresLayer = new GeoJSONLayer({
    url: "https://raw.githubusercontent.com/Ranseleslie/Geog863_Final_Project/main/Grocery_Stores_(view_of_points).geojson",
    title: "Grocery Stores",
    renderer: {
      type: "simple",
      symbol: {
        type: "simple-marker",
        color: "orange",
        size: 10
      }
    },
    popupTemplate: {
      title: "{StoreName}", // Grocery store name
      content: "<b>Address:</b> {Address}" // Grocery store address
    }
  });
  map.add(groceryStoresLayer);

  // Medical Facilities Layer
  const medicalFacilitiesLayer = new GeoJSONLayer({
    url: "https://raw.githubusercontent.com/Ranseleslie/Geog863_Final_Project/main/Medical_Facilities_(points).geojson",
    title: "Medical Facilities",
    renderer: {
      type: "simple",
      symbol: {
        type: "simple-marker",
        color: "red",
        size: 10
      }
    },
    popupTemplate: {
      title: "{FacilityName}", // Medical facility name
      content: "<b>Address:</b> {Address}" // Medical facility address
    }
  });
  map.add(medicalFacilitiesLayer);

  // Shopping Centers Layer
  const shoppingCentersLayer = new GeoJSONLayer({
    url: "https://raw.githubusercontent.com/Ranseleslie/Geog863_Final_Project/main/Existing_Shopping_Centers.geojson",
    title: "Shopping Centers",
    renderer: {
      type: "simple",
      symbol: {
        type: "simple-marker",
        color: "purple",
        size: 10
      }
    },
    popupTemplate: {
      title: "{CenterName}", // Shopping center name
      content: "<b>Address:</b> {Address}" // Shopping center address
    }
  });
  map.add(shoppingCentersLayer);

  // Add LayerList widget to allow toggling of layers
  const layerList = new LayerList({
    view: view
  });

  // Optionally, wrap the LayerList in an Expand widget to save space
  const expand = new Expand({
    view: view,
    content: layerList,
    expandIconClass: "esri-icon-layer-list", // Icon for the expand button
    expanded: true
  });

  view.ui.add(expand, "top-right"); // Add the LayerList widget to the UI

});
